# WaterTrack App
---
## üìù –ó–∞–ª–µ–∂–Ω–æ—Å—Ç—ñ (Dependencies)

–î–æ–¥–∞—Ç–æ–∫ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î –∫—ñ–ª—å–∫–∞ –±—ñ–±–ª—ñ–æ—Ç–µ–∫ Android Jetpack —Ç–∞ Kotlin. –û—Å—å –æ–ø–∏—Å –∫–ª—é—á–æ–≤–∏—Ö –∑–∞–ª–µ–∂–Ω–æ—Å—Ç–µ–π:

* **`androidx.datastore:datastore-preferences:1.1.1`**
    * **–ü–æ—è—Å–Ω–µ–Ω–Ω—è:** –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è –¥–ª—è –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–≥–æ —Ç–∞ –ø–æ—Å—Ç—ñ–π–Ω–æ–≥–æ –∑–±–µ—Ä—ñ–≥–∞–Ω–Ω—è –ø—Ä–æ—Å—Ç–∏—Ö –¥–∞–Ω–∏—Ö —É —Ñ–æ—Ä–º–∞—Ç—ñ "–∫–ª—é—á-–∑–Ω–∞—á–µ–Ω–Ω—è". –£ —Ü—å–æ–º—É –¥–æ–¥–∞—Ç–∫—É, –π–º–æ–≤—ñ—Ä–Ω–æ, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è `WaterDataRepository` –¥–ª—è –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è —Ç–∞ –æ—Ç—Ä–∏–º–∞–Ω–Ω—è —â–æ–¥–µ–Ω–Ω–æ–≥–æ —Å–ø–æ–∂–∏–≤–∞–Ω–Ω—è –≤–æ–¥–∏.

* **`androidx.compose.material:material-icons-extended-android:1.7.2`**
    * **–ü–æ—è—Å–Ω–µ–Ω–Ω—è:** –ù–∞–¥–∞—î —Ä–æ–∑—à–∏—Ä–µ–Ω–∏–π –Ω–∞–±—ñ—Ä —ñ–∫–æ–Ω–æ–∫ Material Design –¥–ª—è –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –≤ —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ñ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞.

* **`androidx.compose.ui:ui-text-google-fonts:1.5.4`**
    * **–ü–æ—è—Å–Ω–µ–Ω–Ω—è:** –î–æ–∑–≤–æ–ª—è—î –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ —à—Ä–∏—Ñ—Ç–∏, —â–æ –∑–∞–≤–∞–Ω—Ç–∞–∂—É—é—Ç—å—Å—è –∑ Google Fonts, —É Jetpack Compose.

* **`androidx.compose.material3:material3:1.2.1`**
    * **–ü–æ—è—Å–Ω–µ–Ω–Ω—è:** –û—Å–Ω–æ–≤–Ω–∞ –±—ñ–±–ª—ñ–æ—Ç–µ–∫–∞ –¥–ª—è —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ñ–≤ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –∑ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞–º–∏ Material Design 3 —É Jetpack Compose.

* **`androidx.navigation:navigation-compose:$nav_version`** (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, 2.8.9)
    * **–ü–æ—è—Å–Ω–µ–Ω–Ω—è:** –°–ø—Ä–æ—â—É—î –Ω–∞–≤—ñ–≥–∞—Ü—ñ—é –º—ñ–∂ —Ä—ñ–∑–Ω–∏–º–∏ –µ–∫—Ä–∞–Ω–∞–º–∏ (Composable —Ñ—É–Ω–∫—Ü—ñ—è–º–∏) —É –¥–æ–¥–∞—Ç–∫—É Jetpack Compose.

* **`kotlinx.serialization.json`**
    * **–ü–æ—è—Å–Ω–µ–Ω–Ω—è:** –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è –¥–ª—è —Å–µ—Ä—ñ–∞–ª—ñ–∑–∞—Ü—ñ—ó –æ–±'—î–∫—Ç—ñ–≤ Kotlin —É —Ñ–æ—Ä–º–∞—Ç JSON —Ç–∞ –¥–µ—Å–µ—Ä—ñ–∞–ª—ñ–∑–∞—Ü—ñ—ó –∑ –Ω—å–æ–≥–æ. –¶–µ –∫–æ—Ä–∏—Å–Ω–æ –¥–ª—è –æ–±—Ä–æ–±–∫–∏ —Å–∫–ª–∞–¥–Ω–∏—Ö —Å—Ç—Ä—É–∫—Ç—É—Ä –¥–∞–Ω–∏—Ö –¥–ª—è –∞—Ä–≥—É–º–µ–Ω—Ç—ñ–≤ –Ω–∞–≤—ñ–≥–∞—Ü—ñ—ó –∞–±–æ –∑–±–µ—Ä—ñ–≥–∞–Ω–Ω—è –¥–∞–Ω–∏—Ö.

* **`androidx.compose.foundation:foundation:1.6.7`**
    * **–ü–æ—è—Å–Ω–µ–Ω–Ω—è:** –ù–∞–¥–∞—î –±–∞–∑–æ–≤—ñ –±—É–¥—ñ–≤–µ–ª—å–Ω—ñ –±–ª–æ–∫–∏ —Ç–∞ –æ—Å–Ω–æ–≤–Ω—É —Ñ—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª—å–Ω—ñ—Å—Ç—å Compose, —Ç–∞–∫—É —è–∫ `HorizontalPager`.

---
## üöÄ MainActivity.kt

–§–∞–π–ª `MainActivity.kt` —î —Ç–æ—á–∫–æ—é –≤—Ö–æ–¥—É –¥–ª—è –ø—Ä–æ–≥—Ä–∞–º–∏.

```kotlin
package com.example.watertrack

import android.os.Bundle
import androidx.activity.ComponentActivity
import androidx.activity.compose.setContent
import androidx.activity.enableEdgeToEdge 
import com.example.watertrack.ui.theme.WaterTrackTheme

class MainActivity : ComponentActivity() {
    override fun onCreate(savedInstanceState: Bundle?) {
        super.onCreate(savedInstanceState)
```
* **`onCreate(savedInstanceState: Bundle?)`**: –¶–µ –ø–µ—Ä—à–∏–π –º–µ—Ç–æ–¥, —è–∫–∏–π –≤–∏–∫–ª–∏–∫–∞—î—Ç—å—Å—è –ø—Ä–∏ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—ñ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—ñ.

```kotlin
        enableEdgeToEdge() 
```
* **`enableEdgeToEdge()`**: –¶–µ–π –≤–∏–∫–ª–∏–∫ —Ñ—É–Ω–∫—Ü—ñ—ó, –π–º–æ–≤—ñ—Ä–Ω–æ, –¥–æ–∑–≤–æ–ª—è—î –¥–æ–¥–∞—Ç–∫—É –º–∞–ª—é–≤–∞—Ç–∏ –∫–æ–Ω—Ç–µ–Ω—Ç –ø—ñ–¥ —Å–∏—Å—Ç–µ–º–Ω–∏–º–∏ –ø–∞–Ω–µ–ª—è–º–∏ (—Ä—è–¥–æ–∫ —Å—Ç–∞–Ω—É —Ç–∞ –ø–∞–Ω–µ–ª—å –Ω–∞–≤—ñ–≥–∞—Ü—ñ—ó) –¥–ª—è –±—ñ–ª—å—à –∑–∞—Ö–æ–ø–ª—é—é—á–æ–≥–æ —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å—É.

```kotlin
        setContent { 
            WaterTrackTheme { 
                Navigation() 
            }
        }
    }
}
```
* **`setContent { ... }`**: –¢—É—Ç –Ω–∞–ª–∞—à—Ç–æ–≤—É—î—Ç—å—Å—è —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ Jetpack Compose.
* **`WaterTrackTheme { ... }`**: –ó–∞—Å—Ç–æ—Å–æ–≤—É—î –∫–∞—Å—Ç–æ–º–Ω—É —Ç–µ–º—É Material (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, –∫–æ–ª—å–æ—Ä–∏, —Ç–∏–ø–æ–≥—Ä–∞—Ñ—ñ–∫—É), –≤–∏–∑–Ω–∞—á–µ–Ω—É –¥–ª—è –ø—Ä–æ–≥—Ä–∞–º–∏, –¥–æ –≤—Å—ñ—Ö Composable —Ñ—É–Ω–∫—Ü—ñ–π –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ.
* **`Navigation()`**: –¶—è Composable —Ñ—É–Ω–∫—Ü—ñ—è –≤–∏–∫–ª–∏–∫–∞—î—Ç—å—Å—è –¥–ª—è –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –Ω–∞–≤—ñ–≥–∞—Ü—ñ–π–Ω–æ–≥–æ –≥—Ä–∞—Ñ–∞ –ø—Ä–æ–≥—Ä–∞–º–∏, –≤–∏–∑–Ω–∞—á–∞—é—á–∏ —Ä—ñ–∑–Ω—ñ –µ–∫—Ä–∞–Ω–∏ —Ç–∞ —Å–ø–æ—Å–æ–±–∏ –ø–µ—Ä–µ—Ö–æ–¥—É –º—ñ–∂ –Ω–∏–º–∏.

---
## üß≠ Navigation.kt

–§–∞–π–ª `Navigation.kt` –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—î –∑–∞ —É–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è –Ω–∞–≤—ñ–≥–∞—Ü—ñ–π–Ω–∏–º –ø–æ—Ç–æ–∫–æ–º —É –ø—Ä–æ–≥—Ä–∞–º—ñ, –ø–µ—Ä–µ–≤–∞–∂–Ω–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ `HorizontalPager` –¥–ª—è –ø–µ—Ä–µ–º–∏–∫–∞–Ω–Ω—è –º—ñ–∂ –µ–∫—Ä–∞–Ω–∞–º–∏ "Home" —Ç–∞ "Stats".

```kotlin
package com.example.watertrack

// ... —ñ–º–ø–æ—Ä—Ç–∏ ...
import androidx.compose.foundation.pager.HorizontalPager 
import androidx.compose.foundation.pager.rememberPagerState 
import kotlinx.coroutines.launch
import kotlinx.serialization.Serializable

@Serializable
sealed class Destinations { 
    @Serializable
    object Home : Destinations() 
    @Serializable
    object Stats : Destinations() 
}
```
* **`Destinations` Sealed Class**: –í–∏–∑–Ω–∞—á–∞—î –º–æ–∂–ª–∏–≤—ñ –Ω–∞–≤—ñ–≥–∞—Ü—ñ–π–Ω—ñ –ø—É–Ω–∫—Ç–∏ –ø—Ä–∏–∑–Ω–∞—á–µ–Ω–Ω—è (`Home` —Ç–∞ `Stats`) –±–µ–∑–ø–µ—á–Ω–∏–º –¥–ª—è —Ç–∏–ø—ñ–≤ —Å–ø–æ—Å–æ–±–æ–º.

```kotlin
data class NavigationScreenItem(val route: Destinations, val text: String, val icon: ImageVector)
```
* **`NavigationScreenItem` Data Class**: –ó–±–µ—Ä—ñ–≥–∞—î —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é –¥–ª—è –∫–æ–∂–Ω–æ–≥–æ –µ–∫—Ä–∞–Ω–∞, –≤–∫–ª—é—á–∞—é—á–∏ –π–æ–≥–æ –º–∞—Ä—à—Ä—É—Ç, —Ç–µ–∫—Å—Ç –¥–ª—è –≤—ñ–¥–æ–±—Ä–∞–∂–µ–Ω–Ω—è —Ç–∞ —ñ–∫–æ–Ω–∫—É.

```kotlin
@OptIn(ExperimentalMaterial3Api::class, androidx.compose.foundation.ExperimentalFoundationApi::class)
@Composable
fun Navigation(modifier: Modifier = Modifier) {
    val screens = listOf(
        NavigationScreenItem(Destinations.Home, "Home", Icons.Default.Home),
        NavigationScreenItem(Destinations.Stats, "Stats", Icons.Default.BarChart)
    )
```
* **`screens` List**: –í–∏–∑–Ω–∞—á–∞—î –µ–∫—Ä–∞–Ω–∏, –¥–æ—Å—Ç—É–ø–Ω—ñ –≤ –ø–µ–π–¥–∂–µ—Ä—ñ —Ç–∞ –Ω–∏–∂–Ω—ñ–π –Ω–∞–≤—ñ–≥–∞—Ü—ñ–π–Ω—ñ–π –ø–∞–Ω–µ–ª—ñ ("Home" —Ç–∞ "Stats").

```kotlin
    val pagerState = rememberPagerState(pageCount = { screens.size }) 
    val coroutineScope = rememberCoroutineScope() 

    val currentScreen = screens[pagerState.currentPage] 
```
* **`rememberPagerState`**: –ö–µ—Ä—É—î —Å—Ç–∞–Ω–æ–º `HorizontalPager`, –Ω–∞–ø—Ä–∏–∫–ª–∞–¥, –ø–æ—Ç–æ—á–Ω–æ—é —Å—Ç–æ—Ä—ñ–Ω–∫–æ—é.
* **`coroutineScope`**: –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è –¥–ª—è –∑–∞–ø—É—Å–∫—É –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∏—Ö –æ–ø–µ—Ä–∞—Ü—ñ–π, –Ω–∞–ø—Ä–∏–∫–ª–∞–¥, –∞–Ω—ñ–º–∞—Ü—ñ—ó –ø—Ä–æ–∫—Ä—É—Ç–∫–∏ –ø–µ–π–¥–∂–µ—Ä–∞.
* **`currentScreen`**: –í–∏–∑–Ω–∞—á–∞—î –ø–æ—Ç–æ—á–Ω–∏–π –∞–∫—Ç–∏–≤–Ω–∏–π –µ–∫—Ä–∞–Ω –Ω–∞ –æ—Å–Ω–æ–≤—ñ —Å—Ç–∞–Ω—É `pagerState`, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è –¥–ª—è –æ–Ω–æ–≤–ª–µ–Ω–Ω—è –∑–∞–≥–æ–ª–æ–≤–∫–∞.

```kotlin
    Scaffold(
        topBar = {
            TopAppBar( 
                title = { Text(currentScreen.text) }, 
                navigationIcon = {
                    Image(
                        painter = painterResource(R.drawable.droplet),
                        contentDescription = "App Icon",
                        modifier = Modifier.padding(horizontal = 12.dp, vertical = 8.dp)
                    )
                },
                colors = TopAppBarDefaults.topAppBarColors(
                    containerColor = MaterialTheme.colorScheme.primaryContainer
                )
            )
        },
```
* **`Scaffold`**: –ù–∞–¥–∞—î —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—É —Å—Ç—Ä—É–∫—Ç—É—Ä—É –º–∞–∫–µ—Ç–∞ (TopAppBar, BottomBar).
* **`TopAppBar`**: –í—ñ–¥–æ–±—Ä–∞–∂–∞—î –∑–∞–≥–æ–ª–æ–≤–æ–∫ –ø–æ—Ç–æ—á–Ω–æ–≥–æ –µ–∫—Ä–∞–Ω–∞ —Ç–∞ —ñ–∫–æ–Ω–∫—É –ø—Ä–æ–≥—Ä–∞–º–∏. –ó–∞–≥–æ–ª–æ–≤–æ–∫ –¥–∏–Ω–∞–º—ñ—á–Ω–æ –æ–Ω–æ–≤–ª—é—î—Ç—å—Å—è –∑–∞–ª–µ–∂–Ω–æ –≤—ñ–¥ –∞–∫—Ç–∏–≤–Ω–æ—ó —Å—Ç–æ—Ä—ñ–Ω–∫–∏ –≤ –ø–µ–π–¥–∂–µ—Ä—ñ.

```kotlin
        bottomBar = {
            NavigationBar { 
                screens.forEachIndexed { index, screenItem ->
                    NavigationBarItem( 
                        selected = pagerState.currentPage == index, 
                        onClick = {
                            coroutineScope.launch {
                                pagerState.animateScrollToPage(index) 
                            }
                        },
                        icon = { Icon(screenItem.icon, contentDescription = screenItem.text) },
                        label = { Text(screenItem.text) }
                    )
                }
            }
        },
        modifier = modifier
    ) { paddingValues ->
```
* **`NavigationBar` (–ù–∏–∂–Ω—è –Ω–∞–≤—ñ–≥–∞—Ü—ñ—è)**:
    * –ü—Ä–æ—Ö–æ–¥–∏—Ç—å –ø–æ —Å–ø–∏—Å–∫—É `screens` –¥–ª—è —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è `NavigationBarItem` –¥–ª—è –∫–æ–∂–Ω–æ–≥–æ –µ–ª–µ–º–µ–Ω—Ç–∞.
    * –û–±—Ä–æ–±–ª—è—î –∫–ª—ñ–∫–∏ –Ω–∞ –µ–ª–µ–º–µ–Ω—Ç–∞—Ö –Ω–∞–≤—ñ–≥–∞—Ü—ñ—ó –¥–ª—è –ø—Ä–æ–∫—Ä—É—á—É–≤–∞–Ω–Ω—è `HorizontalPager` –¥–æ –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω–æ—ó —Å—Ç–æ—Ä—ñ–Ω–∫–∏.
    * –í–∏–¥—ñ–ª—è—î –ø–æ—Ç–æ—á–Ω–∏–π –≤–∏–±—Ä–∞–Ω–∏–π –µ–ª–µ–º–µ–Ω—Ç.

```kotlin
        HorizontalPager( 
            state = pagerState,
            modifier = Modifier.padding(paddingValues) 
        ) { pageIndex ->
            when (screens[pageIndex].route) { 
                is Destinations.Home -> HomeScreen()
                is Destinations.Stats -> StatsScreen() 
            }
        }
    }
}
```
* **`HorizontalPager`**:
    * –¶–µ –æ—Å–Ω–æ–≤–Ω–∏–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –¥–ª—è –Ω–∞–≤—ñ–≥–∞—Ü—ñ—ó –º—ñ–∂ –µ–∫—Ä–∞–Ω–∞–º–∏ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é —Å–≤–∞–π–ø—ñ–≤.
    * –í—ñ–Ω –≤—ñ–¥–æ–±—Ä–∞–∂–∞—î –≤–º—ñ—Å—Ç –ø–æ—Ç–æ—á–Ω–æ—ó —Å—Ç–æ—Ä—ñ–Ω–∫–∏ (`HomeScreen` –∞–±–æ `StatsScreen`) –Ω–∞ –æ—Å–Ω–æ–≤—ñ `pagerState`.

---
## üè† HomeScreen.kt

–§–∞–π–ª `HomeScreen.kt` –≤–∏–∑–Ω–∞—á–∞—î –≥–æ–ª–æ–≤–Ω–∏–π –µ–∫—Ä–∞–Ω –ø—Ä–æ–≥—Ä–∞–º–∏, –¥–µ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ –º–æ–∂—É—Ç—å –≤—ñ–¥—Å—Ç–µ–∂—É–≤–∞—Ç–∏ —Å–≤–æ—î —â–æ–¥–µ–Ω–Ω–µ —Å–ø–æ–∂–∏–≤–∞–Ω–Ω—è –≤–æ–¥–∏.

```kotlin
package com.example.watertrack

// ... —ñ–º–ø–æ—Ä—Ç–∏ ...
import androidx.compose.runtime.saveable.rememberSaveable 
import kotlinx.coroutines.launch
import java.time.LocalDate 

@Composable
fun HomeScreen(modifier: Modifier = Modifier) {
    val goal = 2000 
    var currentProgress by rememberSaveable { mutableStateOf(0f) } 
```
* **`goal`**: –ö–æ–Ω—Å—Ç–∞–Ω—Ç–∞, —â–æ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è—î –¥–µ–Ω–Ω—É –Ω–æ—Ä–º—É —Å–ø–æ–∂–∏–≤–∞–Ω–Ω—è –≤–æ–¥–∏ (2000 –º–ª).
* **`currentProgress`**: `mutableStateOf`, —â–æ –∑–±–µ—Ä—ñ–≥–∞—î—Ç—å—Å—è –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é `rememberSaveable` –¥–ª—è –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è –ø–æ—Ç–æ—á–Ω–æ–≥–æ —Å–ø–æ–∂–∏–≤–∞–Ω–Ω—è –≤–æ–¥–∏, —è–∫–µ –∑–±–µ—Ä—ñ–≥–∞—î—Ç—å—Å—è –ø—Ä–∏ –∑–º—ñ–Ω–∞—Ö –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—ó. –Ü–Ω—ñ—Ü—ñ–∞–ª—ñ–∑—É—î—Ç—å—Å—è –∑–Ω–∞—á–µ–Ω–Ω—è–º 0f.

```kotlin
    val context = LocalContext.current
    val waterRepository = remember { WaterDataRepository(context) } 
    val today = LocalDate.now() 
```
* **`waterRepository`**: –ï–∫–∑–µ–º–ø–ª—è—Ä `WaterDataRepository` –¥–ª—è –≤–∑–∞—î–º–æ–¥—ñ—ó –∑—ñ —Å—Ö–æ–≤–∏—â–µ–º –¥–∞–Ω–∏—Ö.
* **`today`**: –ü–æ—Ç–æ—á–Ω–∞ –¥–∞—Ç–∞, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è –¥–ª—è –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è —Ç–∞ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –¥–∞–Ω–∏—Ö –∑–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–∏–π –¥–µ–Ω—å.

```kotlin
    var isInitialLoadDone by rememberSaveable { mutableStateOf(false) } 
```
* **`isInitialLoadDone`**: –õ–æ–≥—ñ—á–Ω–∏–π –ø—Ä–∞–ø–æ—Ä–µ—Ü—å `rememberSaveable`, —è–∫–∏–π –≥–∞—Ä–∞–Ω—Ç—É—î, —â–æ `currentProgress` –æ–Ω–æ–≤–ª—é—î—Ç—å—Å—è –∑ `DataStore` –ª–∏—à–µ –æ–¥–∏–Ω —Ä–∞–∑ –ø—ñ–¥ —á–∞—Å –ø–æ—á–∞—Ç–∫–æ–≤–æ—ó –∫–æ–º–ø–æ–∑–∏—Ü—ñ—ó.

```kotlin
    val P_loadedProgressFromDataStore by waterRepository.getWaterIntake(today).collectAsState(initial = -1f) 
```
* **`P_loadedProgressFromDataStore`**: –ó–±–∏—Ä–∞—î –¥–∞–Ω—ñ –ø—Ä–æ —Å–ø–æ–∂–∏–≤–∞–Ω–Ω—è –≤–æ–¥–∏ –∑–∞ –ø–æ—Ç–æ—á–Ω–∏–π –¥–µ–Ω—å (`today`) –∑ `waterRepository` —è–∫ `StateFlow`. –Ü–Ω—ñ—Ü—ñ–∞–ª—ñ–∑—É—î—Ç—å—Å—è –∑–Ω–∞—á–µ–Ω–Ω—è–º -1f, —â–æ–± –≤–∫–∞–∑–∞—Ç–∏, —â–æ –¥–∞–Ω—ñ —â–µ –Ω–µ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω—ñ.

```kotlin
    LaunchedEffect(P_loadedProgressFromDataStore, isInitialLoadDone) { 
        if (P_loadedProgressFromDataStore != -1f) { 
            if (!isInitialLoadDone) { 
                currentProgress = P_loadedProgressFromDataStore 
                isInitialLoadDone = true 
            }
        }
    }
```
* **`LaunchedEffect`**:
    * –°–ø–æ—Å—Ç–µ—Ä—ñ–≥–∞—î –∑–∞ `P_loadedProgressFromDataStore` —Ç–∞ `isInitialLoadDone`.
    * –ö–æ–ª–∏ `P_loadedProgressFromDataStore` –æ—Ç—Ä–∏–º—É—î –∑–Ω–∞—á–µ–Ω–Ω—è, –≤—ñ–¥–º—ñ–Ω–Ω–µ –≤—ñ–¥ -1f (—Ç–æ–±—Ç–æ –¥–∞–Ω—ñ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω—ñ), —ñ `isInitialLoadDone` –º–∞—î –∑–Ω–∞—á–µ–Ω–Ω—è false, –≤—ñ–Ω –æ–Ω–æ–≤–ª—é—î `currentProgress` –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–∏–º –∑–Ω–∞—á–µ–Ω–Ω—è–º —ñ –≤—Å—Ç–∞–Ω–æ–≤–ª—é—î `isInitialLoadDone` –≤ true. –¶–µ –∑–∞–ø–æ–±—ñ–≥–∞—î –ø–µ—Ä–µ–∑–∞–ø–∏—Å—É –∑–º—ñ–Ω –ø–æ—Ç–æ—á–Ω–æ–≥–æ —Å–µ–∞–Ω—Å—É –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –∑–±–µ—Ä–µ–∂–µ–Ω–∏–º –∑–Ω–∞—á–µ–Ω–Ω—è–º, —è–∫—â–æ –≤—ñ–Ω –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç—å –Ω–∞ —ñ–Ω—à–∏–π –µ–∫—Ä–∞–Ω —ñ –ø–æ–≤–µ—Ä—Ç–∞—î—Ç—å—Å—è –¥–æ —Ç–æ–≥–æ, —è–∫ –ø–æ—Ç—ñ–∫ –≤–∏–¥–∞—Å—Ç—å –Ω–æ–≤–µ –∑–Ω–∞—á–µ–Ω–Ω—è.

```kotlin
    val coroutineScope = rememberCoroutineScope()

    val updateAndSaveProgress = { newAmount: Float -> 
        val validAmount = newAmount.coerceAtLeast(0f) 
        currentProgress = validAmount 
        if (isInitialLoadDone) {
            coroutineScope.launch {
                waterRepository.saveWaterIntake(today, validAmount)
            }
        }
    }
```
* **`updateAndSaveProgress` Lambda**:
    * –§—É–Ω–∫—Ü—ñ—è, —è–∫–∞ –æ–Ω–æ–≤–ª—é—î —Å—Ç–∞–Ω `currentProgress`.
    * –í–æ–Ω–∞ –≥–∞—Ä–∞–Ω—Ç—É—î, —â–æ –Ω–æ–≤–∞ –∫—ñ–ª—å–∫—ñ—Å—Ç—å –Ω–µ —î –≤—ñ–¥'—î–º–Ω–æ—é (`coerceAtLeast(0f)`).
    * –Ø–∫—â–æ `isInitialLoadDone` –º–∞—î –∑–Ω–∞—á–µ–Ω–Ω—è true (—Ç–æ–±—Ç–æ –ø–æ—á–∞—Ç–∫–æ–≤–µ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –¥–∞–Ω–∏—Ö –∑–∞–≤–µ—Ä—à–µ–Ω–æ), –≤–æ–Ω–∞ –∑–∞–ø—É—Å–∫–∞—î –∫–æ—Ä—É—Ç–∏–Ω—É –¥–ª—è –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è `validAmount` –≤ `waterRepository` –¥–ª—è –ø–æ—Ç–æ—á–Ω–æ–≥–æ –¥–Ω—è `today`. –¶–µ –∑–∞–ø–æ–±—ñ–≥–∞—î –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—é –ø–æ—á–∞—Ç–∫–æ–≤–æ–≥–æ –∑–Ω–∞—á–µ–Ω–Ω—è –∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º (0f –∞–±–æ -1f) –¥–æ —Ç–æ–≥–æ, —è–∫ –±—É–¥—É—Ç—å –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω—ñ —Ñ–∞–∫—Ç–∏—á–Ω—ñ –¥–∞–Ω—ñ –∞–±–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á –≤–∑–∞—î–º–æ–¥—ñ—è—Ç–∏–º–µ.

```kotlin
    Column(
        modifier = modifier.fillMaxSize(),
        horizontalAlignment = Alignment.CenterHorizontally
    ) {
        Column( /* ... –¥–ª—è –∑–∞–≥–æ–ª–æ–≤–∫—É —Ç–∞ —Ç–µ–∫—Å—Ç—É –ø—Ä–æ–≥—Ä–µ—Å—É ... */ ) {
            Text("Today's progress", /* ... */)
            Text("${currentProgress.toInt()}ml / ${goal}ml", /* ... */)

            Box( /* ... –¥–ª—è –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –ø—Ä–æ –¥–æ—Å—è–≥–Ω–µ–Ω–Ω—è —Ü—ñ–ª—ñ ... */ ) {
                if (currentProgress >= goal) {
                    Text( /* ... Great job! ... */ )
                }
            }
        }
```
* **–ú–∞–∫–µ—Ç UI**: `Column` –≤–ø–æ—Ä—è–¥–∫–æ–≤—É—î –µ–ª–µ–º–µ–Ω—Ç–∏ –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω–æ. –í—ñ–¥–æ–±—Ä–∞–∂–∞—î —Ç–µ–∫—Å—Ç "Today's progress" —Ç–∞ –ø–æ—Ç–æ—á–Ω–µ —Å–ø–æ–∂–∏–≤–∞–Ω–Ω—è –≤—ñ–¥–Ω–æ—Å–Ω–æ —Ü—ñ–ª—ñ (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, "500ml / 2000ml"). –£–º–æ–≤–Ω–µ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –∑'—è–≤–ª—è—î—Ç—å—Å—è, —è–∫—â–æ —Ü—ñ–ª—å –¥–æ—Å—è–≥–Ω—É—Ç–∞ –∞–±–æ –ø–µ—Ä–µ–≤–∏—â–µ–Ω–∞.

```kotlin
        FillingCircleWithBorder(
            modifier = Modifier.fillMaxWidth(0.75f).height(240.dp).padding(16.dp),
            progress = (currentProgress / goal).coerceIn(0f, 1f), 
            currentProgress = currentProgress,
            dailyGoal = goal,
            // ... —ñ–Ω—à—ñ –ø–∞—Ä–∞–º–µ—Ç—Ä–∏ –∫–æ–ª—å–æ—Ä—ñ–≤ —Ç–∞ —Ç–µ–∫—Å—Ç—É ...
        )
```
* **`FillingCircleWithBorder` Composable**:
    * –ö–∞—Å—Ç–æ–º–Ω–∏–π Composable, —è–∫–∏–π –≤—ñ–∑—É–∞–ª—å–Ω–æ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è—î –ø—Ä–æ–≥—Ä–µ—Å —Å–ø–æ–∂–∏–≤–∞–Ω–Ω—è –≤–æ–¥–∏ —É –≤–∏–≥–ª—è–¥—ñ –∑–∞–ø–æ–≤–Ω—é–≤–∞–Ω–æ–≥–æ –∫–æ–ª–∞.
    * `progress`: –û–±—á–∏—Å–ª—é—î—Ç—å—Å—è —è–∫ `(currentProgress / goal).coerceIn(0f, 1f)`, —â–æ–± –≥–∞—Ä–∞–Ω—Ç—É–≤–∞—Ç–∏, —â–æ –∑–Ω–∞—á–µ–Ω–Ω—è –∑–Ω–∞—Ö–æ–¥–∏—Ç—å—Å—è –≤ –º–µ–∂–∞—Ö –≤—ñ–¥ 0 –¥–æ 1.
    * –í–∏–≥–ª—è–¥ –∫–æ–ª–∞ (–∫–æ–ª—å–æ—Ä–∏) –∑–º—ñ–Ω—é—î—Ç—å—Å—è, –∫–æ–ª–∏ —Ü—ñ–ª—å –¥–æ—Å—è–≥–Ω—É—Ç–∞.
    * –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î `animateFloatAsState` –¥–ª—è –ø–ª–∞–≤–Ω–æ—ó –∞–Ω—ñ–º–∞—Ü—ñ—ó —Ä—ñ–≤–Ω—è –∑–∞–ø–æ–≤–Ω–µ–Ω–Ω—è.
    * –í—ñ–¥–æ–±—Ä–∞–∂–∞—î –≤—ñ–¥—Å–æ—Ç–æ–∫ –∞–±–æ —Ç–µ–∫—Å—Ç "AMAZING!" –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ –∫–æ–ª–∞.
    * `Icon` (–∫—Ä–∞–ø–ª—è) –≤—ñ–¥–æ–±—Ä–∞–∂–∞—î—Ç—å—Å—è –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ –∫–æ–ª–∞.

```kotlin
        Spacer(modifier = Modifier.height(24.dp))

        Column( /* ... –¥–ª—è –∫–Ω–æ–ø–æ–∫ –¥–æ–¥–∞–≤–∞–Ω–Ω—è –≤–æ–¥–∏ ... */ ) {
            Text("Add water intake", /* ... */)
            Row( /* ... –∫–Ω–æ–ø–∫–∏ +100ml, +250ml, +500ml ... */ ) {
                WaterButton(text = "+100ml", onClick = { updateAndSaveProgress(currentProgress + 100f) })
                WaterButton(text = "+250ml", onClick = { updateAndSaveProgress(currentProgress + 250f) })
                WaterButton(text = "+500ml", onClick = { updateAndSaveProgress(currentProgress + 500f) })
            }
            Row( /* ... –∫–Ω–æ–ø–∫–∏ "Full Cup", -100ml ... */ ) {
                WaterButton(text = "Full Cup\n(330ml)", onClick = { updateAndSaveProgress(currentProgress + 330f) })
                WaterButton(text = "-100ml", onClick = { updateAndSaveProgress(currentProgress - 100f) }, /* ... —ñ–Ω—à—ñ –∫–æ–ª—å–æ—Ä–∏ ... */)
            }
        }
    }
}
```
* **–ö–Ω–æ–ø–∫–∏ –¥–æ–¥–∞–≤–∞–Ω–Ω—è –≤–æ–¥–∏**:
    * –†–æ–∑–¥—ñ–ª —ñ–∑ –∑–∞–≥–æ–ª–æ–≤–∫–æ–º "Add water intake".
    * –ö—ñ–ª—å–∫–∞ Composable `WaterButton` –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—Ç—å—Å—è –¥–ª—è —à–≤–∏–¥–∫–æ–≥–æ –¥–æ–¥–∞–≤–∞–Ω–Ω—è –ø–æ–ø–µ—Ä–µ–¥–Ω—å–æ –≤–∏–∑–Ω–∞—á–µ–Ω–∏—Ö –æ–±'—î–º—ñ–≤ –≤–æ–¥–∏ (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, +100–º–ª, +250–º–ª, +500–º–ª, "Full Cup (330–º–ª)").
    * –¢–∞–∫–æ–∂ —î –∫–Ω–æ–ø–∫–∞ –¥–ª—è –≤—ñ–¥–Ω—ñ–º–∞–Ω–Ω—è –≤–æ–¥–∏ (-100–º–ª), —Å—Ç–∏–ª—ñ–∑–æ–≤–∞–Ω–∞ –ø–æ-—ñ–Ω—à–æ–º—É (–∫–æ–ª—å–æ—Ä–∏ –ø–æ–º–∏–ª–∫–∏).
    * `onClick` –∫–æ–∂–Ω–æ—ó –∫–Ω–æ–ø–∫–∏ –≤–∏–∫–ª–∏–∫–∞—î `updateAndSaveProgress` –∑ –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω–∏–º –æ–±'—î–º–æ–º.

```kotlin
@Composable
fun WaterButton(
    text: String,
    onClick: () -> Unit,
    modifier: Modifier = Modifier,
    // ... –ø–∞—Ä–∞–º–µ—Ç—Ä–∏ –∫–æ–ª—å–æ—Ä—ñ–≤ —Ç–∞ —Ä–æ–∑–º—ñ—Ä—ñ–≤ ...
) {
    Button(onClick = onClick, /* ... —Ñ–æ—Ä–º–∞, –∫–æ–ª—å–æ—Ä–∏, –º–æ–¥–∏—Ñ—ñ–∫–∞—Ç–æ—Ä ... */) {
        Text(text = text, /* ... —Å—Ç–∏–ª—å —Ç–µ–∫—Å—Ç—É ... */)
    }
}
```
* **`WaterButton` Composable**: –°—Ç–∏–ª—ñ–∑–æ–≤–∞–Ω–∞ `Button` –¥–ª—è –±–∞–≥–∞—Ç–æ—Ä–∞–∑–æ–≤–æ–≥–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –≤ —Ü—å–æ–º—É –¥–æ–¥–∞—Ç–∫—É. –ü—Ä–∏–π–º–∞—î —Ç–µ–∫—Å—Ç, –¥—ñ—é `onClick`, –∫–æ–ª—å–æ—Ä–∏ —Ç–∞ —Ä–æ–∑–º—ñ—Ä–∏ —è–∫ –ø–∞—Ä–∞–º–µ—Ç—Ä–∏.

```kotlin
@Composable
fun FillingCircleWithBorder( 
    progress: Float,
    currentProgress: Float,
    dailyGoal: Int,
    modifier: Modifier = Modifier,
    // ... –ø–∞—Ä–∞–º–µ—Ç—Ä–∏ –∫–æ–ª—å–æ—Ä—ñ–≤, —ñ–∫–æ–Ω–∫–∏ ...
) {
    val animatedProgress by animateFloatAsState(targetValue = progress, label = "progressAnimation") 
    val goalReached = currentProgress >= dailyGoal 

    // ... –≤–∏–∑–Ω–∞—á–µ–Ω–Ω—è –∫–æ–ª—å–æ—Ä—ñ–≤ –∑–∞–ª–µ–∂–Ω–æ –≤—ñ–¥ goalReached ...

    Box(modifier = modifier, contentAlignment = Alignment.Center) {
        Canvas(modifier = Modifier.fillMaxSize()) {
            // ... —Ä–æ–∑—Ä–∞—Ö—É–Ω–∫–∏ —Ä–æ–∑–º—ñ—Ä—ñ–≤, —Ä–∞–¥—ñ—É—Å–∞ ...
            val fillHeightValue = 2 * radius * animatedProgress 

            // ... –º–∞–ª—é–≤–∞–Ω–Ω—è —Ñ–æ–Ω–æ–≤–æ–≥–æ –∫–æ–ª–∞, –æ–±—Ä—ñ–∑–∫–∞ –∫–æ–Ω—Ç—É—Ä—É, –º–∞–ª—é–≤–∞–Ω–Ω—è –ø—Ä—è–º–æ–∫—É—Ç–Ω–∏–∫–∞ –∑–∞–ø–æ–≤–Ω–µ–Ω–Ω—è, –º–∞–ª—é–≤–∞–Ω–Ω—è —Ä–∞–º–∫–∏ ...
        }
        Column( /* ... –¥–ª—è —ñ–∫–æ–Ω–∫–∏ —Ç–∞ —Ç–µ–∫—Å—Ç—É –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ –∫–æ–ª–∞ ... */ ) {
            Icon(painter = painterResource(icon), /* ... */)
            Text(text = if (goalReached) "AMAZING!" else "${(animatedProgress * 100).toInt()}%", /* ... */)
            if (goalReached) {
                Text(text = "${(currentProgress / dailyGoal * 100).toInt()}%", /* ... */)
            }
        }
    }
}
```
* **–õ–æ–≥—ñ–∫–∞ –º–∞–ª—é–≤–∞–Ω–Ω—è `FillingCircleWithBorder`**:
    * –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î `Canvas` –¥–ª—è –º–∞–ª—é–≤–∞–Ω–Ω—è –∫–∞—Å—Ç–æ–º–Ω–æ—ó –≥—Ä–∞—Ñ—ñ–∫–∏.
    * –ú–∞–ª—é—î —Ñ–æ–Ω–æ–≤–µ –∫–æ–ª–æ, –ø–æ—Ç—ñ–º –∑–∞–ø–æ–≤–Ω–µ–Ω–∏–π –ø—Ä—è–º–æ–∫—É—Ç–Ω–∏–∫ (–æ–±—Ä—ñ–∑–∞–Ω–∏–π –∑–∞ –∫–æ–Ω—Ç—É—Ä–æ–º –∫–æ–ª–∞) –¥–ª—è –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–Ω—è –ø—Ä–æ–≥—Ä–µ—Å—É, —ñ, –Ω–∞—Ä–µ—à—Ç—ñ, –∑–æ–≤–Ω—ñ—à–Ω—é —Ä–∞–º–∫—É.
    * –í–∏—Å–æ—Ç–∞ –∑–∞–ø–æ–≤–Ω–µ–Ω–Ω—è (`fillHeightValue`) –æ–±—á–∏—Å–ª—é—î—Ç—å—Å—è –Ω–∞ –æ—Å–Ω–æ–≤—ñ `animatedProgress`.

---
## üìä StatsScreen.kt

–§–∞–π–ª `StatsScreen.kt` –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—î –∑–∞ –≤—ñ–¥–æ–±—Ä–∞–∂–µ–Ω–Ω—è —ñ—Å—Ç–æ—Ä—ñ—ó —Å–ø–æ–∂–∏–≤–∞–Ω–Ω—è –≤–æ–¥–∏ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–µ–º.

```kotlin
package com.example.watertrack

// ... —ñ–º–ø–æ—Ä—Ç–∏ ...
import com.example.watertrack.data.WaterDataRepository
import java.time.LocalDate
import java.time.format.DateTimeFormatter
import java.time.format.FormatStyle 

@Composable
fun StatsScreen(modifier: Modifier = Modifier) {
    val context = LocalContext.current
    val waterRepository = remember { WaterDataRepository(context) }
```
* **`waterRepository`**: –ï–∫–∑–µ–º–ø–ª—è—Ä `WaterDataRepository` –¥–ª—è –æ—Ç—Ä–∏–º–∞–Ω–Ω—è —ñ—Å—Ç–æ—Ä–∏—á–Ω–∏—Ö –¥–∞–Ω–∏—Ö.

```kotlin
    val waterHistory by waterRepository.getAllWaterIntakeHistory().collectAsState(initial = emptyMap()) 
```
* **`waterHistory`**: –ó–±–∏—Ä–∞—î –≤—Å—é —ñ—Å—Ç–æ—Ä—ñ—é —Å–ø–æ–∂–∏–≤–∞–Ω–Ω—è –≤–æ–¥–∏ –∑ `waterRepository` —è–∫ `StateFlow`. –¶–µ `Map<String, Float>`, –¥–µ –∫–ª—é—á - —Ü–µ —Ä—è–¥–æ–∫ –¥–∞—Ç–∏, –∞ –∑–Ω–∞—á–µ–Ω–Ω—è - –∫—ñ–ª—å–∫—ñ—Å—Ç—å —Å–ø–æ–∂–∏—Ç–æ—ó –≤–æ–¥–∏. –Ü–Ω—ñ—Ü—ñ–∞–ª—ñ–∑—É—î—Ç—å—Å—è –ø–æ—Ä–æ–∂–Ω—å–æ—é –∫–∞—Ä—Ç–æ—é.

```kotlin
    Column(
        modifier = modifier.fillMaxSize().padding(16.dp),
        horizontalAlignment = Alignment.CenterHorizontally
    ) {
        Text(
            "Your Water Intake History",
            style = MaterialTheme.typography.headlineSmall,
            modifier = Modifier.padding(bottom = 16.dp)
        )
```
* **–ú–∞–∫–µ—Ç UI**: `Column` –¥–ª—è –∑–∞–≥–∞–ª—å–Ω–æ–≥–æ –º–∞–∫–µ—Ç–∞. –ó–∞–≥–æ–ª–æ–≤–æ–∫ "Your Water Intake History".

```kotlin
        if (waterHistory.isEmpty()) { 
            Text(
                "No data yet. Start tracking your water intake!",
                style = MaterialTheme.typography.bodyLarge
            )
        } else { 
            val P_displayList = waterHistory.toList() 
```
* **–£–º–æ–≤–Ω–∏–π –≤–º—ñ—Å—Ç**:
    * –Ø–∫—â–æ `waterHistory` –ø–æ—Ä–æ–∂–Ω—è, –≤—ñ–¥–æ–±—Ä–∞–∂–∞—î—Ç—å—Å—è "No data yet. Start tracking your water intake!".
    * –í —ñ–Ω—à–æ–º—É –≤–∏–ø–∞–¥–∫—É, —ñ—Å—Ç–æ—Ä—ñ—è –≤—ñ–¥–æ–±—Ä–∞–∂–∞—î—Ç—å—Å—è –≤ `LazyColumn`.
* **`P_displayList`**: –ö–∞—Ä—Ç–∞ `waterHistory` –ø–µ—Ä–µ—Ç–≤–æ—Ä—é—î—Ç—å—Å—è –Ω–∞ —Å–ø–∏—Å–æ–∫ –ø–∞—Ä (`List<Pair<String, Float>>`) –¥–ª—è `LazyColumn`. –£ –∫–æ–º–µ–Ω—Ç–∞—Ä—ñ –∑–∞–∑–Ω–∞—á–µ–Ω–æ, —â–æ —Å–æ—Ä—Ç—É–≤–∞–Ω–Ω—è –∫–ª—é—á—ñ–≤ (–¥–∞—Ç) –æ—á—ñ–∫—É—î—Ç—å—Å—è –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—ó.

```kotlin
            LazyColumn( 
                modifier = Modifier.fillMaxSize(),
                verticalArrangement = Arrangement.spacedBy(8.dp)
            ) {
                items(P_displayList) { (dateString, intake) -> 
                    val P_displayDate = try {
                        LocalDate.parse(dateString, DateTimeFormatter.ISO_LOCAL_DATE)
                            .format(DateTimeFormatter.ofLocalizedDate(FormatStyle.MEDIUM))
                    } catch (e: Exception) {
                        dateString 
                    }
                    WaterHistoryItem(date = P_displayDate, intake = intake.toInt()) 
                }
            }
        }
    }
}
```
* **`LazyColumn` –¥–ª—è —ñ—Å—Ç–æ—Ä—ñ—ó**:
    * –ï—Ñ–µ–∫—Ç–∏–≤–Ω–æ –≤—ñ–¥–æ–±—Ä–∞–∂–∞—î —Å–ø–∏—Å–æ–∫ —ñ—Å—Ç–æ—Ä–∏—á–Ω–∏—Ö –∑–∞–ø–∏—Å—ñ–≤.
    * `items(P_displayList)`: –ü—Ä–æ—Ö–æ–¥–∏—Ç—å –ø–æ —ñ—Å—Ç–æ—Ä–∏—á–Ω–∏—Ö –¥–∞–Ω–∏—Ö.
    * –î–ª—è –∫–æ–∂–Ω–æ–≥–æ –∑–∞–ø–∏—Å—É –Ω–∞–º–∞–≥–∞—î—Ç—å—Å—è —Ä–æ–∑–ø–∞—Ä—Å–∏—Ç–∏ —Ä—è–¥–æ–∫ –¥–∞—Ç–∏ (`dateString`) –≤ `LocalDate`, –∞ –ø–æ—Ç—ñ–º –≤—ñ–¥—Ñ–æ—Ä–º–∞—Ç—É–≤–∞—Ç–∏ –π–æ–≥–æ –≤ –±—ñ–ª—å—à —á–∏—Ç–∞–±–µ–ª—å–Ω—É –ª–æ–∫–∞–ª—ñ–∑–æ–≤–∞–Ω—É –¥–∞—Ç—É (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, "22 —Ç—Ä–∞–≤. 2025 —Ä."). –Ø–∫—â–æ —Ä–æ–∑–±—ñ—Ä –Ω–µ –≤–¥–∞—î—Ç—å—Å—è, –≤—ñ–¥–æ–±—Ä–∞–∂–∞—î—Ç—å—Å—è –≤–∏—Ö—ñ–¥–Ω–∏–π —Ä—è–¥–æ–∫ –¥–∞—Ç–∏ —è–∫ –∑–∞–ø–∞—Å–Ω–∏–π –≤–∞—Ä—ñ–∞–Ω—Ç. –¶–µ –ø–æ–∑–Ω–∞—á–µ–Ω–æ —è–∫ –ø–æ—Ç–µ–Ω—Ü—ñ–π–Ω–∏–π "–Ω–µ–¥–æ–ª—ñ–∫", —è–∫—â–æ —Ä–æ–∑–±—ñ—Ä –Ω–µ –≤–¥–∞—Å—Ç—å—Å—è.
    * –ö–æ–∂–µ–Ω –µ–ª–µ–º–µ–Ω—Ç —ñ—Å—Ç–æ—Ä—ñ—ó –≤—ñ–¥–æ–±—Ä–∞–∂–∞—î—Ç—å—Å—è –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é Composable `WaterHistoryItem`.

```kotlin
@Composable
fun WaterHistoryItem(date: String, intake: Int, modifier: Modifier = Modifier) { 
    Card( 
        modifier = modifier.fillMaxWidth(),
        elevation = CardDefaults.cardElevation(defaultElevation = 2.dp),
        colors = CardDefaults.cardColors(containerColor = MaterialTheme.colorScheme.surfaceVariant)
    ) {
        Row( 
            modifier = Modifier.padding(16.dp).fillMaxWidth(),
            horizontalArrangement = Arrangement.SpaceBetween,
            verticalAlignment = Alignment.CenterVertically
        ) {
            Text(text = date, style = MaterialTheme.typography.bodyLarge) 
            Text(
                text = "${intake}ml",
                style = MaterialTheme.typography.bodyLarge,
                fontWeight = FontWeight.Bold,
                color = MaterialTheme.colorScheme.primary
            )
        }
    }
}
```
* **`WaterHistoryItem` Composable**:
    * `Card` Composable –¥–ª—è –≤—ñ–¥–æ–±—Ä–∞–∂–µ–Ω–Ω—è –æ–¥–Ω–æ–≥–æ –∑–∞–ø–∏—Å—É –ø—Ä–æ —Å–ø–æ–∂–∏–≤–∞–Ω–Ω—è –≤–æ–¥–∏ –∑–∞ –¥–µ–Ω—å.
    * –ü–æ–∫–∞–∑—É—î –≤—ñ–¥—Ñ–æ—Ä–º–∞—Ç–æ–≤–∞–Ω—É –¥–∞—Ç—É —Ç–∞ –∫—ñ–ª—å–∫—ñ—Å—Ç—å —Å–ø–æ–∂–∏—Ç–æ—ó –≤–æ–¥–∏ (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, "22 —Ç—Ä–∞–≤. 2025 —Ä." —Ç–∞ "1500ml").
    * –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î `Row` –¥–ª—è —Ä–æ–∑—Ç–∞—à—É–≤–∞–Ω–Ω—è –¥–∞—Ç–∏ —Ç–∞ –∫—ñ–ª—å–∫–æ—Å—Ç—ñ –ø–æ—Ä—É—á.

---
## üóÑÔ∏è WaterDataRepository.kt

–§–∞–π–ª `WaterDataRepository.kt` –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—î –∑–∞ —É–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è –¥–∞–Ω–∏–º–∏ –ø—Ä–æ —Å–ø–æ–∂–∏–≤–∞–Ω–Ω—è –≤–æ–¥–∏, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ DataStore –¥–ª—è –ø–æ—Å—Ç—ñ–π–Ω–æ–≥–æ –∑–±–µ—Ä—ñ–≥–∞–Ω–Ω—è.

```kotlin
package com.example.watertrack.data

import android.content.Context
import androidx.datastore.core.DataStore
import androidx.datastore.preferences.core.Preferences
import androidx.datastore.preferences.core.edit
import androidx.datastore.preferences.core.floatPreferencesKey
import androidx.datastore.preferences.preferencesDataStore
import kotlinx.coroutines.flow.Flow
import kotlinx.coroutines.flow.map
import java.time.LocalDate
import java.time.format.DateTimeFormatter

val Context.dataStore: DataStore<Preferences> by preferencesDataStore(name = "water_prefs_datastore") 
```
* **Context Extension**: –°—Ç–≤–æ—Ä—é—î —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è –¥–ª—è `Context`, —è–∫–µ –∑–∞–±–µ–∑–ø–µ—á—É—î –¥–æ—Å—Ç—É–ø –¥–æ —î–¥–∏–Ω–æ–≥–æ –µ–∫–∑–µ–º–ø–ª—è—Ä–∞ `DataStore<Preferences>` –∑ –Ω–∞–∑–≤–æ—é "water_prefs_datastore".

```kotlin
class WaterDataRepository(private val context: Context) {

    private val dateFormatter = DateTimeFormatter.ISO_LOCAL_DATE // –§–æ—Ä–º–∞—Ç: yyyy-MM-dd
```
* **`WaterDataRepository` Class**: –û—Å–Ω–æ–≤–Ω–∏–π –∫–ª–∞—Å –¥–ª—è —Ä–æ–±–æ—Ç–∏ –∑ –¥–∞–Ω–∏–º–∏ –ø—Ä–æ —Å–ø–æ–∂–∏–≤–∞–Ω–Ω—è –≤–æ–¥–∏.
* **`dateFormatter`**: –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î ISO —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∏–π —Ñ–æ—Ä–º–∞—Ç –¥–∞—Ç–∏ (yyyy-MM-dd) –¥–ª—è —É–∑–≥–æ–¥–∂–µ–Ω–æ–≥–æ —Ñ–æ—Ä–º–∞—Ç—É–≤–∞–Ω–Ω—è –∫–ª—é—á—ñ–≤.

```kotlin
    private fun getPreferenceKey(date: LocalDate): Preferences.Key<Float> {
        return floatPreferencesKey(date.format(dateFormatter))
    }
```
* **`getPreferenceKey` Method**: –ü–µ—Ä–µ—Ç–≤–æ—Ä—é—î `LocalDate` —É `Preferences.Key<Float>`, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ –≤—ñ–¥—Ñ–æ—Ä–º–∞—Ç–æ–≤–∞–Ω—É –¥–∞—Ç—É —è–∫ –∫–ª—é—á. –¶–µ –∑–∞–±–µ–∑–ø–µ—á—É—î —É–∑–≥–æ–¥–∂–µ–Ω—ñ—Å—Ç—å —É —Ç–æ–º—É, —è–∫ –¥–∞—Ç–∏ –∑–±–µ—Ä—ñ–≥–∞—é—Ç—å—Å—è —Ç–∞ –æ—Ç—Ä–∏–º—É—é—Ç—å—Å—è –∑ DataStore.

```kotlin
    suspend fun saveWaterIntake(date: LocalDate, amount: Float) {
        context.dataStore.edit { preferences ->
            preferences[getPreferenceKey(date)] = amount
        }
    }
```
* **`saveWaterIntake` Method**: 
    * –ó–±–µ—Ä—ñ–≥–∞—î –∫—ñ–ª—å–∫—ñ—Å—Ç—å —Å–ø–æ–∂–∏—Ç–æ—ó –≤–æ–¥–∏ (`amount`) –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ—ó –¥–∞—Ç–∏ (`date`).
    * –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î `context.dataStore.edit` –¥–ª—è –∞—Ç–æ–º–∞—Ä–Ω–æ–≥–æ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è –∑–Ω–∞—á–µ–Ω–Ω—è.
    * `suspend` —Ñ—É–Ω–∫—Ü—ñ—è, —Ç–æ–º—É —â–æ –æ–ø–µ—Ä–∞—Ü—ñ—ó DataStore —î –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∏–º–∏.

```kotlin
    fun getWaterIntake(date: LocalDate): Flow<Float> {
        return context.dataStore.data.map { preferences ->
            preferences[getPreferenceKey(date)] ?: 0f
        }
    }
```
* **`getWaterIntake` Method**:
    * –ü–æ–≤–µ—Ä—Ç–∞—î `Flow<Float>` –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ—ó –¥–∞—Ç–∏, —â–æ –¥–æ–∑–≤–æ–ª—è—î —Ä–µ–∞–∫—Ç–∏–≤–Ω–µ —Å–ø–æ—Å—Ç–µ—Ä–µ–∂–µ–Ω–Ω—è –∑–∞ –∑–º—ñ–Ω–∞–º–∏ –¥–∞–Ω–∏—Ö.
    * –Ø–∫—â–æ –¥–∞–Ω—ñ –¥–ª—è –¥–∞—Ç–∏ –Ω–µ –∑–Ω–∞–π–¥–µ–Ω—ñ, –ø–æ–≤–µ—Ä—Ç–∞—î 0f —è–∫ –∑–Ω–∞—á–µ–Ω–Ω—è –∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º.
    * `Flow` –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –µ–º—ñ—Ç—É—î –Ω–æ–≤—ñ –∑–Ω–∞—á–µ–Ω–Ω—è –ø—Ä–∏ –∑–º—ñ–Ω—ñ –¥–∞–Ω–∏—Ö —É DataStore.

```kotlin
    fun getAllWaterIntakeHistory(): Flow<Map<String, Float>> {
        return context.dataStore.data.map { preferences ->
            preferences.asMap()
                .filterKeys { key ->
                    try {
                        LocalDate.parse(key.name, dateFormatter)
                        true
                    } catch (e: Exception) {
                        false
                    }
                }
```
* **`getAllWaterIntakeHistory` Method**: –ü–æ–≤–µ—Ä—Ç–∞—î –≤—Å—é —ñ—Å—Ç–æ—Ä—ñ—é —Å–ø–æ–∂–∏–≤–∞–Ω–Ω—è –≤–æ–¥–∏ —è–∫ `Flow<Map<String, Float>>`.
* **–§—ñ–ª—å—Ç—Ä–∞—Ü—ñ—è –∫–ª—é—á—ñ–≤**: –ü–µ—Ä–µ–≤—ñ—Ä—è—î, —á–∏ –∫–æ–∂–µ–Ω –∫–ª—é—á —É DataStore –º–æ–∂–µ –±—É—Ç–∏ —Ä–æ–∑–ø–∞—Ä—Å–µ–Ω–∏–π —è–∫ –¥–∞—Ç–∞. –¶–µ –¥–æ–ø–æ–º–∞–≥–∞—î –≤—ñ–¥—Ñ—ñ–ª—å—Ç—Ä—É–≤–∞—Ç–∏ –±—É–¥—å-—è–∫—ñ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ñ –∫–ª—é—á—ñ, —è–∫—ñ –º–æ–≥–ª–∏ –± –ø–æ—Ç—Ä–∞–ø–∏—Ç–∏ –¥–æ DataStore.

```kotlin
                .mapNotNull { (key, value) ->
                    if (value is Float) {
                        key.name to value
                    } else {
                        null
                    }
                }
                .toMap()
```
* **–ü–µ—Ä–µ—Ç–≤–æ—Ä–µ–Ω–Ω—è —Ç–∏–ø—ñ–≤**: –ü–µ—Ä–µ—Ç–≤–æ—Ä—é—î –∫–ª—é—á—ñ –Ω–∞ —Ä—è–¥–∫–∏ (`key.name`) —Ç–∞ –ø–µ—Ä–µ–≤—ñ—Ä—è—î, —â–æ –∑–Ω–∞—á–µ–Ω–Ω—è —î —Ç–∏–ø—É `Float`. `mapNotNull` –≤—ñ–¥—Ñ—ñ–ª—å—Ç—Ä–æ–≤—É—î –±—É–¥—å-—è–∫—ñ –Ω–µ–¥—ñ–π—Å–Ω—ñ –∑–∞–ø–∏—Å–∏.

```kotlin
                .toSortedMap(compareByDescending { it })
        }
    }
}
```
* **–°–æ—Ä—Ç—É–≤–∞–Ω–Ω—è**: –°—Ç–≤–æ—Ä—é—î –≤—ñ–¥—Å–æ—Ä—Ç–æ–≤–∞–Ω—É –º–∞–ø—É –∑ –¥–∞—Ç–∞–º–∏ –≤ –ø–æ—Ä—è–¥–∫—É —Å–ø–∞–¥–∞–Ω–Ω—è (–Ω–∞–π–Ω–æ–≤—ñ—à—ñ –¥–∞—Ç–∏ —Å–ø–æ—á–∞—Ç–∫—É). –§–æ—Ä–º–∞—Ç "yyyy-MM-dd" –¥–æ–∑–≤–æ–ª—è—î –ø—Ä–∞–≤–∏–ª—å–Ω–µ –ª–µ–∫—Å–∏–∫–æ–≥—Ä–∞—Ñ—ñ—á–Ω–µ —Å–æ—Ä—Ç—É–≤–∞–Ω–Ω—è —Ä—è–¥–∫—ñ–≤, –∞–ª–µ —Ü–µ –º–æ–∂–µ –±—É—Ç–∏ –Ω–µ–æ—á–µ–≤–∏–¥–Ω–æ –¥–ª—è –ø–æ—á–∞—Ç–∫—ñ–≤—Ü—ñ–≤.
